var cov_709c73fcb=function(){var path="/home/adrianzhu/Avarus-App/avarus-api/logic/user/edit-user/index.js";var hash="5e48d8ccf98fe56a947b7650a584cca870c21cb0";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/adrianzhu/Avarus-App/avarus-api/logic/user/edit-user/index.js",statementMap:{"0":{start:{line:1,column:79},end:{line:1,column:101}},"1":{start:{line:2,column:39},end:{line:2,column:61}},"2":{start:{line:3,column:15},end:{line:3,column:34}},"3":{start:{line:19,column:0},end:{line:66,column:1}},"4":{start:{line:21,column:2},end:{line:21,column:21}},"5":{start:{line:22,column:2},end:{line:22,column:35}},"6":{start:{line:23,column:2},end:{line:23,column:78}},"7":{start:{line:23,column:29},end:{line:23,column:78}},"8":{start:{line:25,column:2},end:{line:29,column:3}},"9":{start:{line:26,column:4},end:{line:26,column:26}},"10":{start:{line:27,column:4},end:{line:27,column:43}},"11":{start:{line:28,column:4},end:{line:28,column:25}},"12":{start:{line:31,column:2},end:{line:35,column:3}},"13":{start:{line:32,column:4},end:{line:32,column:29}},"14":{start:{line:33,column:4},end:{line:33,column:49}},"15":{start:{line:37,column:2},end:{line:40,column:3}},"16":{start:{line:38,column:4},end:{line:38,column:65}},"17":{start:{line:39,column:4},end:{line:39,column:37}},"18":{start:{line:43,column:2},end:{line:65,column:6}},"19":{start:{line:44,column:17},end:{line:44,column:40}},"20":{start:{line:46,column:4},end:{line:46,column:70}},"21":{start:{line:46,column:15},end:{line:46,column:70}},"22":{start:{line:48,column:4},end:{line:48,column:221}},"23":{start:{line:48,column:74},end:{line:48,column:221}},"24":{start:{line:50,column:19},end:{line:50,column:21}},"25":{start:{line:52,column:4},end:{line:52,column:35}},"26":{start:{line:54,column:4},end:{line:57,column:5}},"27":{start:{line:55,column:19},end:{line:55,column:50}},"28":{start:{line:56,column:6},end:{line:56,column:28}},"29":{start:{line:59,column:4},end:{line:59,column:32}},"30":{start:{line:61,column:4},end:{line:61,column:65}},"31":{start:{line:63,column:4},end:{line:63,column:15}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:19,column:17},end:{line:19,column:18}},loc:{start:{line:19,column:65},end:{line:66,column:1}},line:19},"1":{name:"(anonymous_1)",decl:{start:{line:43,column:10},end:{line:43,column:11}},loc:{start:{line:43,column:22},end:{line:65,column:3}},line:43}},branchMap:{"0":{loc:{start:{line:23,column:2},end:{line:23,column:78}},type:"if",locations:[{start:{line:23,column:2},end:{line:23,column:78}},{start:{line:23,column:2},end:{line:23,column:78}}],line:23},"1":{loc:{start:{line:25,column:2},end:{line:29,column:3}},type:"if",locations:[{start:{line:25,column:2},end:{line:29,column:3}},{start:{line:25,column:2},end:{line:29,column:3}}],line:25},"2":{loc:{start:{line:31,column:2},end:{line:35,column:3}},type:"if",locations:[{start:{line:31,column:2},end:{line:35,column:3}},{start:{line:31,column:2},end:{line:35,column:3}}],line:31},"3":{loc:{start:{line:37,column:2},end:{line:40,column:3}},type:"if",locations:[{start:{line:37,column:2},end:{line:40,column:3}},{start:{line:37,column:2},end:{line:40,column:3}}],line:37},"4":{loc:{start:{line:46,column:4},end:{line:46,column:70}},type:"if",locations:[{start:{line:46,column:4},end:{line:46,column:70}},{start:{line:46,column:4},end:{line:46,column:70}}],line:46},"5":{loc:{start:{line:48,column:4},end:{line:48,column:221}},type:"if",locations:[{start:{line:48,column:4},end:{line:48,column:221}},{start:{line:48,column:4},end:{line:48,column:221}}],line:48},"6":{loc:{start:{line:48,column:7},end:{line:48,column:72}},type:"binary-expr",locations:[{start:{line:48,column:8},end:{line:48,column:16}},{start:{line:48,column:20},end:{line:48,column:36}},{start:{line:48,column:42},end:{line:48,column:71}}],line:48},"7":{loc:{start:{line:52,column:4},end:{line:52,column:35}},type:"binary-expr",locations:[{start:{line:52,column:4},end:{line:52,column:9}},{start:{line:52,column:14},end:{line:52,column:34}}],line:52},"8":{loc:{start:{line:54,column:4},end:{line:57,column:5}},type:"if",locations:[{start:{line:54,column:4},end:{line:57,column:5}},{start:{line:54,column:4},end:{line:57,column:5}}],line:54}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0,0],"7":[0,0],"8":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"5e48d8ccf98fe56a947b7650a584cca870c21cb0"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();const{validate,errors:{NotFoundError,ContentError,CredentialsError}}=(cov_709c73fcb.s[0]++,require('avarus-util'));const{ObjectId,models:{User}}=(cov_709c73fcb.s[1]++,require('avarus-data'));const bcrypt=(cov_709c73fcb.s[2]++,require('bcryptjs'));/**
 *
 * edit-user
 * 
 * @param {id} ObjectId
 * @param {name} string
 * @param {surname} string
 * @param {username} string
 * 
 * @returns {ObjectId} 
 * 
 */cov_709c73fcb.s[3]++;module.exports=function(id,email,password,verifiedPassword){cov_709c73fcb.f[0]++;cov_709c73fcb.s[4]++;validate.string(id);cov_709c73fcb.s[5]++;validate.string.notVoid('id',id);cov_709c73fcb.s[6]++;if(!ObjectId.isValid(id)){cov_709c73fcb.b[0][0]++;cov_709c73fcb.s[7]++;throw new ContentError(`${id} is not a valid id`);}else{cov_709c73fcb.b[0][1]++;}cov_709c73fcb.s[8]++;if(email){cov_709c73fcb.b[1][0]++;cov_709c73fcb.s[9]++;validate.string(email);cov_709c73fcb.s[10]++;validate.string.notVoid('email',email);cov_709c73fcb.s[11]++;validate.email(email);}else{cov_709c73fcb.b[1][1]++;}cov_709c73fcb.s[12]++;if(password){cov_709c73fcb.b[2][0]++;cov_709c73fcb.s[13]++;validate.string(password);cov_709c73fcb.s[14]++;validate.string.notVoid('password',password);}else{cov_709c73fcb.b[2][1]++;}cov_709c73fcb.s[15]++;if(verifiedPassword){cov_709c73fcb.b[3][0]++;cov_709c73fcb.s[16]++;validate.string.notVoid('verifiedPassword',verifiedPassword);cov_709c73fcb.s[17]++;validate.string(verifiedPassword);}else{cov_709c73fcb.b[3][1]++;}cov_709c73fcb.s[18]++;return(async()=>{cov_709c73fcb.f[1]++;const user=(cov_709c73fcb.s[19]++,await User.findById(id));cov_709c73fcb.s[20]++;if(!user){cov_709c73fcb.b[4][0]++;cov_709c73fcb.s[21]++;throw new NotFoundError(`user with id ${id} not found`);}else{cov_709c73fcb.b[4][1]++;}cov_709c73fcb.s[22]++;if(((cov_709c73fcb.b[6][0]++,password)||(cov_709c73fcb.b[6][1]++,verifiedPassword))&&(cov_709c73fcb.b[6][2]++,password!==verifiedPassword)){cov_709c73fcb.b[5][0]++;cov_709c73fcb.s[23]++;throw new CredentialsError(`failed to modify password, passwords are not the same, please introduce correctly your password and it's verification`);}else{cov_709c73fcb.b[5][1]++;}const update=(cov_709c73fcb.s[24]++,{});cov_709c73fcb.s[25]++;(cov_709c73fcb.b[7][0]++,email)&&(cov_709c73fcb.b[7][1]++,update.email=email);cov_709c73fcb.s[26]++;if(password){cov_709c73fcb.b[8][0]++;const hash=(cov_709c73fcb.s[27]++,await bcrypt.hash(password,10));cov_709c73fcb.s[28]++;update.password=hash;}else{cov_709c73fcb.b[8][1]++;}cov_709c73fcb.s[29]++;update.lastAccess=new Date();cov_709c73fcb.s[30]++;await User.updateOne({_id:ObjectId(id)},{$set:update});cov_709c73fcb.s[31]++;user.save();})();};